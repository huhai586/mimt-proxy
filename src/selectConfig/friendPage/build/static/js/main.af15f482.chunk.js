(this.webpackJsonpchooseconfig=this.webpackJsonpchooseconfig||[]).push([[0],{108:function(e,t,n){e.exports=n(180)},113:function(e,t,n){},114:function(e,t,n){},175:function(e,t,n){},176:function(e,t,n){e.exports=n.p+"static/media/rootCA.45130045.crt"},178:function(e,t,n){e.exports=n.p+"static/media/pac-tip.eea764fb.png"},180:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(8),c=n.n(i),r=(n(113),n(48)),s=n(49),l=n(54),f=n(50),u=n(56),d=n(187),p=n(76),m=n(182),g=n(183),C=n(190),E=n(184),N=n(188),h=n(10),O=(n(114),n(185)),v=n(186),y=n(181),_=n(189),S=O.a.confirm,A=v.a.Meta,I={ban:"ban",select:"select",edit:"edit",turnOn:"turnOn"},b=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(i)))).restartConfirm=function(){S({title:"\u5207\u6362\u914d\u7f6e",content:"\u4ee3\u7406\u670d\u52a1\u5668\u8fd0\u884c\u4e2d\uff0c\u9700\u8981\u6362\u5230\u5f53\u524d\u914d\u7f6e\u5417\uff1f",okText:"\u597d\u7684",okType:"danger",cancelText:"\u53d6\u6d88\u5207\u6362",onOk:function(){n.selectConfigConfirm()},onCancel:function(){console.log("Cancel")}})},n.selectCurItem=function(){n.selectConfigConfirm()},n.selectConfigConfirm=function(){n.props.selectConfig(n.props.data)},n.editCurItem=function(){n.props.editConfig(n.props.data)},n.banItem=function(){n.props.banConfig(n.props.data)},n.turnOnItem=function(){n.props.turnOnItem(n.props.data)},n.doAction=function(e){switch(e){case I.select:n.selectCurItem();break;case I.edit:n.editCurItem();break;case I.ban:n.banItem();break;case I.turnOn:n.turnOnItem();break;default:console.log("\u6ca1\u6709\u76f8\u5e94\u7684action",e)}},n.turnOffProxyServer=function(){n.props.stopCurConfig&&n.props.stopCurConfig()},n.getItemActions=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[o.a.createElement("div",{className:"icon-container",onClick:function(){n.doAction(I.edit)}},o.a.createElement(h.a,{type:"edit",key:"edit"}),o.a.createElement("span",null,"\u4fee\u6539"))];return e?(t.push(o.a.createElement("div",{className:"icon-container",onClick:function(){n.doAction(I.ban)}},o.a.createElement(h.a,{type:"delete",key:"delete"}),o.a.createElement("span",null,"\u7981\u7528"))),t.unshift(o.a.createElement("div",{className:"icon-container",onClick:function(){n.doAction(I.select)}},o.a.createElement(h.a,{type:"heart",key:"heart"}),o.a.createElement("span",null,"\u9009\u62e9")))):t.push(o.a.createElement("div",{className:"icon-container",onClick:function(){n.doAction(I.turnOn)}},o.a.createElement(h.a,{type:"plus",key:"plus"}),o.a.createElement("span",null,"\u542f\u7528"))),t},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.data;return o.a.createElement(y.a,{wrapperClassName:"config-item-solo",spinning:this.props.runing,tip:o.a.createElement("div",{onClick:this.turnOffProxyServer},"\u4ee3\u7406\u4e2d,\u70b9\u51fb\u53ef\u505c\u6b62... ")},o.a.createElement("div",null,o.a.createElement(v.a,{title:o.a.createElement("div",null,o.a.createElement(_.a,{count:this.props.itemIndex+1,style:{backgroundColor:"#52c41a"}}),e.fileData.description),actions:this.getItemActions(e.fileData.enable)},o.a.createElement(A,{description:o.a.createElement("div",null,e.fileData.description?e.fileData.description:"".concat(e.fileName,"\u65e0\u63cf\u8ff0"))}))))}}]),t}(a.Component),T=(n(175),n(176)),w=d.a.Panel,k=p.a.TabPane,G={FETCH_ALL_CONFIGS:"getAllConfig",SELECT_CONFIG:"select_config",BAN_CONFIG:"ban_config",TURN_ON_CONFIG:"turn_on_config",EDIT_CONFIG:"edit_config",START_CALLBACK:"start_callback",GET_CURRENT_CONFIG:"get_current_config",CHECK_UPDATE:"CHECK_UPDATE",STOP_CONFIG:"STOP_CONFIG",GET_PAC_ADDRESS:"GET_PAC_ADDRESS"},D=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(i)))).state={configs:[],startUpSuc:!1,runningConfigsName:[],connectError:!1,pacAddress:"",fetchAllConfigSuc:!1},n.selectConfig=function(e){var t={action:G.SELECT_CONFIG,payload:e};n.ws.send(JSON.stringify(t))},n.editConfig=function(e){var t={action:G.EDIT_CONFIG,payload:e};n.ws.send(JSON.stringify(t))},n.banConfig=function(e){var t={action:G.BAN_CONFIG,payload:e};n.ws.send(JSON.stringify(t))},n.turnOnItem=function(e){var t={action:G.TURN_ON_CONFIG,payload:e};n.ws.send(JSON.stringify(t))},n.showMsg=function(e,t){m.a[e](t)},n.getPacAddress=function(){n.ws.send(JSON.stringify({action:G.GET_PAC_ADDRESS}))},n.processStartUp=function(e){n.showMsg(e.startSuc?"success":"error",e.msg),n.setState({startUpSuc:e.startSuc},(function(){n.state.startUpSuc&&(n.setState({runningConfigsName:e.fileName}),n.getPacAddress())})),n.ws.send(JSON.stringify({action:G.GET_CURRENT_CONFIG}))},n.setCurrentConfig=function(e){var t=e.map((function(e){return e.fileName}));n.setState({runningConfigsName:t}),0===t.length&&n.ws.send(JSON.stringify({action:G.GET_PAC_ADDRESS}))},n.setPacAddress=function(e){n.setState({pacAddress:e})},n.setSelectedItemData=function(e){n.setState({curItemConfig:e})},n.versionCompare=function(e){var t=e.latestVersion,a=e.localVersion;if(t!==a){var o="\u68c0\u6d4b\u5230\u65b0\u7248\u672c".concat(t,",\u5f53\u524d\u7248\u672c\u4e3a").concat(a,",\u8bf7\u5347\u7ea7\u83b7\u5f97\u66f4\u591a\u4ee3\u7406\u89c4\u5219\u652f\u6301 + \u9519\u8bef\u4fee\u590d");n.showUpdateTip(o)}},n.getCurConfig=function(){n.fetchAllConfig(),n.ws.send(JSON.stringify({action:G.GET_CURRENT_CONFIG}))},n.fetchAllConfig=function(){n.ws.send(JSON.stringify({action:G.FETCH_ALL_CONFIGS}))},n.checkUpdate=function(e){var t={action:G.CHECK_UPDATE,payload:e};n.ws.send(JSON.stringify(t))},n.showUpdateTip=function(e,t){g.a.info({message:t||"b-proxy-cli \u68c0\u6d4b\u5230\u65b0\u7248\u672c",duration:null,description:e})},n.stopConfig=function(e){var t={action:G.STOP_CONFIG,payload:e};n.ws.send(JSON.stringify(t))},n.renderCard=function(e){return 0===e.length?o.a.createElement(C.a,{message:'\u6ca1\u6709\u914d\u7f6e\u88ab\u542f\u7528\uff0c\u53bb"\u672a\u542f\u7528"\u9009\u9879\u5361\u4e2d\u9009\u62e9\u4e00\u4e2a\u5427',type:"warning"}):o.a.createElement("div",{className:"config-item-container"},e.map((function(e,t){return o.a.createElement(b,{selectConfig:n.selectConfig,editConfig:n.editConfig,banConfig:n.banConfig,turnOnItem:n.turnOnItem,stopCurConfig:function(){n.stopConfig(e.fileName)},data:e,proxyIsRunning:0!==n.state.runningConfigsName.length,runing:n.state.runningConfigsName.includes(e.fileName),key:t,itemIndex:t})})))},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.t)}},{key:"componentDidMount",value:function(){var e=this,t=new WebSocket("ws://localhost:9876");this.ws=t,t.addEventListener("open",(function(t){console.log("Connection open ..."),e.setState({connectError:!1}),e.getCurConfig(),e.checkUpdate(),e.t=setInterval(e.fetchAllConfig,3e3)})),t.addEventListener("message",(function(t){var n;console.log("Received Message: ",t.data);try{n=JSON.parse(t.data)}catch(f){return void console.warn("\u4f20\u9012\u6570\u636e\u65e0\u6cd5json\u5316\uff0c\u683c\u5f0f\u9519\u8bef")}if(n.action===G.FETCH_ALL_CONFIGS&&(e.state.configs.length!==n.payload.length&&!0===e.state.fetchAllConfigSuc&&e.showUpdateTip("\u68c0\u6d4b\u5230\u914d\u7f6e\u6587\u4ef6\u6570\u91cf\u53d8\u5316\uff0c\u5df2\u7ecf\u66f4\u65b0\u6700\u65b0\u914d\u7f6e","\u914d\u7f6e\u6587\u4ef6\u5df2\u66f4\u65b0"),e.setState({configs:n.payload,fetchAllConfigSuc:!0})),n.action===G.START_CALLBACK){var a=n.payload;e.processStartUp(a)}if(n.action===G.GET_CURRENT_CONFIG){var o=n.payload;o&&e.setCurrentConfig(o),e.getPacAddress()}if(n.action===G.GET_PAC_ADDRESS){var i=n.payload;i&&e.setPacAddress(i)}if(n.action===G.EDIT_CONFIG){var c=n.payload;c&&e.setSelectedItemData(c)}if(n.action===G.CHECK_UPDATE){var r=n.payload;r&&e.versionCompare(r)}if(n.action===G.BAN_CONFIG){var s=n.payload;s&&e.showMsg("warning","".concat(s.fileName,"\u914d\u7f6e\u5df2\u7ecf\u88ab\u7981\u7528"))}if(n.action===G.TURN_ON_CONFIG){var l=n.payload;l&&e.showMsg("info","".concat(l.fileName,"\u914d\u7f6e\u5df2\u542f\u7528"))}})),t.addEventListener("close",(function(t){console.log("Connection closed."),e.setState({connectError:!0}),setTimeout((function(){window.location.reload()}),1e4)}))}},{key:"render",value:function(){var e=this.state.configs.filter((function(e){return void 0===e.fileData.enable||e.fileData.enable})),t=this.state.configs.filter((function(e){return!1===e.fileData.enable}));return o.a.createElement("div",{className:"App"},this.state.connectError&&o.a.createElement(C.a,{message:"\u4e0e\u4ee3\u7406\u670d\u52a1\u5668\u7684\u901a\u4fe1\u5931\u8d25",description:"\u4ee3\u7406\u670d\u52a1\u5668\u53ef\u80fd\u6ca1\u6709\u542f\u52a8,10s\u540e\u7f51\u9875\u4f1a\u5237\u65b0\u91cd\u8bd5...",type:"error",showIcon:!0}),o.a.createElement("div",{className:"config-container"},o.a.createElement(p.a,{type:"card"},o.a.createElement(k,{tab:"\u5df2\u542f\u7528",key:"1"},this.renderCard(e)),o.a.createElement(k,{tab:"\u672a\u542f\u7528",key:"2"},this.renderCard(t)))),o.a.createElement(E.a,null),o.a.createElement("div",{className:"footer"},o.a.createElement("a",{href:T,target:"_blank",download:!0},"\u70b9\u51fb\u4e0b\u8f7d\u6839\u8bc1\u4e66"),o.a.createElement("div",null,o.a.createElement("p",null,"            windows\u4e0b\u914d\u7f6e\u4fe1\u4efb\u6839\u8bc1\u4e66\uff1a",o.a.createElement("a",{target:"_blank",href:"https://jingyan.baidu.com/article/9f7e7ec0c1107c6f29155461.html"},"\u70b9\u51fb\u67e5\u770b")),o.a.createElement("p",null,"mac\u4e0b\u914d\u7f6e\u4fe1\u4efb\u6839\u8bc1\u4e66\uff1a",o.a.createElement("a",{target:"_blank",href:"https://blog.51cto.com/viming/2161919"},"\u70b9\u51fb\u67e5\u770b"))),!this.state.connectError&&o.a.createElement("div",null,o.a.createElement("span",{className:"pac-config"},"\u81ea\u52a8\u4ee3\u7406\u914d\u7f6eurl\uff1a",this.state.pacAddress),o.a.createElement(N.a,{content:o.a.createElement("div",null,o.a.createElement("img",{src:n(178),alt:""})),title:"\u5728mac\u4e2d\u914d\u7f6e\u81ea\u52a8\u4ee3\u7406\u94fe\u63a5"},o.a.createElement(h.a,{type:"question-circle"}))),o.a.createElement(E.a,null),o.a.createElement(d.a,{accordion:!0},o.a.createElement(w,{header:"\u5982\u4f55\u5907\u4efd\u6211\u7684\u914d\u7f6e",key:"1"},o.a.createElement("p",null,"\u7ec4\u4ef6\u5347\u7ea7\u7684\u65f6\u5019\uff0c\u4f1a\u8986\u76d6\u5b89\u88c5\u7ec4\u4ef6\uff0c\u8986\u76d6\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3a\u4e86\u4fdd\u5b58\u4f60\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8bf7\u62f7\u8d1d\u914d\u7f6e\u6587\u4ef6\u5230\u5176\u4ed6\u5730\u65b9\uff0c\u5f53\u66f4\u65b0\u540e\uff0c\u62f7\u8d1d\u56de\u6765\u5373\u53ef")))))}}]),t}(a.Component);n(179);c.a.render(o.a.createElement(D,null),document.getElementById("root"))}},[[108,1,2]]]);
//# sourceMappingURL=main.af15f482.chunk.js.map