{"version":3,"sources":["rootCA.crt","imgs/pac-tip.png","configItem.js","App.js","index.js"],"names":["module","exports","confirm","Modal","Meta","Card","itemAction","ban","select","edit","turnOn","ConfigItem","restartConfirm","title","content","okText","okType","cancelText","onOk","selectConfigConfirm","onCancel","console","log","selectCurItem","props","selectConfig","data","editCurItem","editConfig","banItem","banConfig","turnOnItem","doAction","action","turnOffProxyServer","stopCurConfig","getItemActions","enable","actionsDefault","className","onClick","type","key","push","unshift","this","wrapperClassName","spinning","runing","tip","count","itemIndex","style","backgroundColor","fileData","description","actions","fileName","Component","crt","require","Panel","Collapse","TabPane","Tabs","App","state","configs","startUpSuc","runningConfigsName","connectError","pacAddress","fetchAllConfigSuc","params","SELECT_CONFIG","payload","ws","send","JSON","stringify","EDIT_CONFIG","BAN_CONFIG","TURN_ON_CONFIG","showMsg","status","info","message","getPacAddress","GET_PAC_ADDRESS","processStartUp","startSuc","msg","setState","GET_CURRENT_CONFIG","setCurrentConfig","fileNames","map","v","length","setPacAddress","setSelectedItemData","curItemConfig","versionCompare","latestVersion","localVersion","text","showUpdateTip","getCurConfig","fetchAllConfig","FETCH_ALL_CONFIGS","checkUpdate","CHECK_UPDATE","notification","duration","stopConfig","STOP_CONFIG","renderCard","items","index","proxyIsRunning","includes","clearInterval","t","WebSocket","addEventListener","evt","setInterval","result","parse","e","warn","START_CALLBACK","setTimeout","window","location","reload","configAllowed","filter","undefined","configDisAllowed","showIcon","tab","href","target","download","src","alt","accordion","header","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.af15f482.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/rootCA.45130045.crt\";","module.exports = __webpack_public_path__ + \"static/media/pac-tip.eea764fb.png\";","import './item.css';\n\nimport React,{Component} from 'react';\nimport {Card, Icon, Avatar, Spin, Modal, Badge} from 'antd';\nconst { confirm } = Modal;\n\nconst { Meta } = Card;\n\nconst itemAction = {\n  ban: 'ban',\n  select: 'select',\n  edit: 'edit',\n  turnOn: 'turnOn'\n}\nexport default  class ConfigItem extends Component{\n  restartConfirm = () => {\n    confirm({\n      title: '切换配置',\n      content: '代理服务器运行中，需要换到当前配置吗？',\n      okText: '好的',\n      okType: 'danger',\n      cancelText: '取消切换',\n      onOk: () => {\n        this.selectConfigConfirm()\n      },\n      onCancel() {\n        console.log('Cancel');\n      },\n    });\n  }\n  \n  selectCurItem = () => {\n    this.selectConfigConfirm();\n  }\n  selectConfigConfirm = () => {\n    this.props.selectConfig(this.props.data)\n  \n  }\n  editCurItem = () => {\n    this.props.editConfig(this.props.data);\n  }\n  banItem = () => {\n    this.props.banConfig(this.props.data);\n  }\n  turnOnItem = () => {\n    this.props.turnOnItem(this.props.data);\n  }\n  doAction = (action) => {\n    switch (action) {\n      case itemAction.select:\n        this.selectCurItem();\n        break;\n      case itemAction.edit:\n        this.editCurItem();\n        break;\n      case itemAction.ban:\n        this.banItem();\n        break;\n      case itemAction.turnOn:\n        this.turnOnItem();\n        break;\n      default:\n        console.log('没有相应的action', action)\n    }\n  }\n  turnOffProxyServer = () => {\n    this.props.stopCurConfig && this.props.stopCurConfig()\n  }\n  getItemActions = (enable = true) => {\n    const actionsDefault = [\n      <div className=\"icon-container\" onClick={() => {this.doAction(itemAction.edit)}}>\n        <Icon type=\"edit\" key=\"edit\"/>\n        <span>修改</span>\n      </div>\n    ]\n    if (enable) {\n      actionsDefault.push(\n        <div className=\"icon-container\" onClick={() => {this.doAction(itemAction.ban)}}>\n          <Icon type=\"delete\" key=\"delete\"/>\n          <span>禁用</span>\n        </div>\n      )\n      actionsDefault.unshift(\n        <div className=\"icon-container\" onClick={() => {this.doAction(itemAction.select)}}>\n          <Icon type=\"heart\" key=\"heart\"/>\n          <span>选择</span>\n        </div>\n      )\n    } else {\n      actionsDefault.push(\n        <div className=\"icon-container\" onClick={() => {this.doAction(itemAction.turnOn)}}>\n          <Icon type=\"plus\" key=\"plus\"/>\n          <span>启用</span>\n        </div>\n      )\n    }\n    return actionsDefault\n  }\n  render(){\n    const {data} = this.props;\n    return (\n      <Spin\n        wrapperClassName = 'config-item-solo'\n        spinning={this.props.runing} tip={<div onClick={this.turnOffProxyServer}>代理中,点击可停止... </div>}>\n        <div>\n          <Card\n            title={<div>\n              <Badge count={this.props.itemIndex + 1} style={{ backgroundColor: '#52c41a' }} />\n              {data.fileData.description}</div>}\n              actions={this.getItemActions(data.fileData.enable)}\n          >\n            <Meta\n              description={<div>\n                {data.fileData.description ? data.fileData.description : `${data.fileName}无描述`}</div>}\n            />\n          </Card>\n        </div>\n      </Spin>\n      \n    )\n  }\n}\n","\nimport React, {Component} from 'react';\nimport {message, Alert, notification, Divider, Collapse, Popover, Tabs, Icon} from 'antd';\n\nimport ConfigItem from './configItem';\nimport './App.css';\n\nconst crt = require(\"./rootCA.crt\");\nconst { Panel } = Collapse;\nconst { TabPane } = Tabs;\n\n\n\n\nconst actions = {\n  'FETCH_ALL_CONFIGS': 'getAllConfig',\n  'SELECT_CONFIG': 'select_config',\n  'BAN_CONFIG': 'ban_config',\n  'TURN_ON_CONFIG': 'turn_on_config',\n  'EDIT_CONFIG': 'edit_config',\n  'START_CALLBACK':'start_callback',\n  'GET_CURRENT_CONFIG': 'get_current_config',\n  'CHECK_UPDATE': 'CHECK_UPDATE',\n  'STOP_CONFIG': 'STOP_CONFIG',\n  'GET_PAC_ADDRESS': 'GET_PAC_ADDRESS'\n}\n\n\nclass App extends Component {\n  state = {\n    configs: [],\n    startUpSuc: false,\n    runningConfigsName: [],\n    connectError: false,\n    pacAddress: '',\n    fetchAllConfigSuc: false\n  }\n  selectConfig = (data) => {\n    const params = {\n      action: actions.SELECT_CONFIG,\n      payload: data\n    }\n    this.ws.send(JSON.stringify(params))\n  }\n  editConfig = (data) => {\n    const params = {\n      action: actions.EDIT_CONFIG,\n      payload: data\n    }\n    this.ws.send(JSON.stringify(params))\n  }\n  banConfig = (data) => {\n    const params = {\n      action: actions.BAN_CONFIG,\n      payload: data\n    }\n    this.ws.send(JSON.stringify(params))\n  }\n  turnOnItem = (data) => {\n    const params = {\n      action: actions.TURN_ON_CONFIG,\n      payload: data\n    }\n    this.ws.send(JSON.stringify(params))\n  }\n  showMsg = (status, info) => {\n    message[status](info)\n  }\n  getPacAddress = () => {\n    this.ws.send(JSON.stringify({action: actions.GET_PAC_ADDRESS}));\n  }\n  processStartUp = (payload) => {\n    this.showMsg(payload.startSuc ? 'success' : 'error', payload.msg);\n    this.setState({startUpSuc: payload.startSuc}, () => {\n      // !this.state.startUpSuc && this.restartConfirm()\n      if (this.state.startUpSuc) {\n        this.setState({runningConfigsName: payload.fileName});\n        this.getPacAddress();\n      }\n    });\n    //获取所有启动项目\n    this.ws.send(JSON.stringify({action: actions.GET_CURRENT_CONFIG}));\n  }\n  setCurrentConfig = (payload) => {\n    // debugger\n    const fileNames = payload.map(v => v.fileName);\n    this.setState({runningConfigsName: fileNames});\n    if (fileNames.length === 0) {\n      this.ws.send(JSON.stringify({action: actions.GET_PAC_ADDRESS}));\n    }\n  }\n  setPacAddress = (pacAddress) => {\n    this.setState({pacAddress})\n  }\n  setSelectedItemData = (data) => {\n    this.setState({curItemConfig: data})\n  }\n  versionCompare = ({latestVersion,localVersion}) => {\n    if (latestVersion !== localVersion) {\n      const text = `检测到新版本${latestVersion},当前版本为${localVersion},请升级获得更多代理规则支持 + 错误修复`\n      this.showUpdateTip(text)\n    }\n  }\n  getCurConfig = () => {\n    this.fetchAllConfig();\n    this.ws.send(JSON.stringify({action: actions.GET_CURRENT_CONFIG}));\n  }\n  fetchAllConfig = () => {\n    this.ws.send(JSON.stringify({action: actions.FETCH_ALL_CONFIGS}));\n  }\n  componentWillUnmount() {\n    clearInterval(this.t)\n  }\n  \n  componentDidMount() {\n    //发送请求获取配置信息\n    let ws = new WebSocket(\"ws://localhost:9876\");\n    this.ws = ws;\n    \n    ws.addEventListener(\"open\",(evt) => {\n      console.log(\"Connection open ...\");\n      // ws.send(\"Hello WebSockets!\");\n      this.setState({connectError: false});\n      this.getCurConfig();\n      this.checkUpdate();\n      this.t = setInterval(this.fetchAllConfig, 3000)\n    })\n  \n  \n    ws.addEventListener(\"message\",(evt) => {\n      console.log( \"Received Message: \" , evt.data);\n      // ws.close();\n      let result ;\n      try {\n        result = JSON.parse(evt.data);\n      } catch (e) {\n        console.warn('传递数据无法json化，格式错误');\n        return\n      }\n      if (result.action === actions.FETCH_ALL_CONFIGS) {\n        if ((this.state.configs.length !== result.payload.length) && (this.state.fetchAllConfigSuc === true)) {\n          this.showUpdateTip('检测到配置文件数量变化，已经更新最新配置', \"配置文件已更新\");\n        }\n        this.setState({configs: result.payload, fetchAllConfigSuc: true});\n      }\n      if (result.action === actions.START_CALLBACK) {\n        const {payload} = result;\n        this.processStartUp(payload)\n      }\n      if (result.action === actions.GET_CURRENT_CONFIG) {\n        const {payload} = result;\n        payload && this.setCurrentConfig(payload);\n        this.getPacAddress();\n      }\n      if (result.action === actions.GET_PAC_ADDRESS) {\n        const {payload} = result;\n        payload && this.setPacAddress(payload)\n      }\n      if (result.action === actions.EDIT_CONFIG) {\n        const {payload} = result;\n        payload && this.setSelectedItemData(payload)\n      }\n      if (result.action === actions.CHECK_UPDATE) {\n        const {payload} = result;\n        payload && this.versionCompare(payload)\n      }\n      if (result.action === actions.BAN_CONFIG) {\n        const {payload} = result;\n        payload && this.showMsg(\"warning\", `${payload.fileName}配置已经被禁用`)\n      }\n      if (result.action === actions.TURN_ON_CONFIG) {\n        const {payload} = result;\n        payload && this.showMsg(\"info\", `${payload.fileName}配置已启用`)\n      }\n      \n    })\n  \n    ws.addEventListener('close', (evt) => {\n      console.log(\"Connection closed.\");\n      this.setState({connectError: true});\n      setTimeout(() => {\n        window.location.reload()\n      }, 10000)\n    });\n  }\n  checkUpdate = (data) => {\n    const params = {\n      action: actions.CHECK_UPDATE,\n      payload: data\n    }\n    this.ws.send(JSON.stringify(params))\n  }\n  showUpdateTip = (text, message) => {\n    notification['info']({\n      message: message || 'b-proxy-cli 检测到新版本',\n      duration:null,\n      description:text\n    });\n  \n  }\n  stopConfig = (fileName) => {\n    const params = {\n      action: actions.STOP_CONFIG,\n      payload: fileName\n    }\n    this.ws.send(JSON.stringify(params));\n    // setTimeout(this.getCurConfig,1000)\n  }\n  renderCard = (items) => {\n    if (items.length === 0) {\n      return <Alert message='没有配置被启用，去\"未启用\"选项卡中选择一个吧' type=\"warning\" />\n    }\n    return <div className=\"config-item-container\">\n      {\n        items.map((v,index) => {\n          return (\n            <ConfigItem\n              selectConfig={this.selectConfig}\n              editConfig={this.editConfig}\n              banConfig={this.banConfig}\n              turnOnItem={this.turnOnItem}\n              stopCurConfig={()=>{this.stopConfig(v.fileName)}}\n              data = {v}\n              proxyIsRunning={this.state.runningConfigsName.length !== 0}\n              runing={this.state.runningConfigsName.includes(v.fileName)}\n              key={index}\n              itemIndex={index}\n            />\n          )\n        })\n      }\n    </div>\n  }\n  render(){\n    const configAllowed = this.state.configs.filter(v => {\n      return v.fileData.enable === undefined ? true :  v.fileData.enable\n    })\n    const configDisAllowed = this.state.configs.filter(v => {\n      return v.fileData.enable === false\n    })\n    return (\n      <div className=\"App\">\n        \n        {this.state.connectError && (\n          <Alert\n            message=\"与代理服务器的通信失败\"\n            description=\"代理服务器可能没有启动,10s后网页会刷新重试...\"\n            type=\"error\"\n            showIcon\n          />\n        )}\n          <div className={'config-container'}>\n            <Tabs  type=\"card\">\n              <TabPane tab=\"已启用\" key=\"1\">\n                {this.renderCard(configAllowed)}\n              </TabPane>\n              <TabPane tab=\"未启用\" key=\"2\">\n                {this.renderCard(configDisAllowed)}\n              </TabPane>\n            \n            </Tabs>\n            \n           \n          </div>\n        <Divider/>\n        \n        <div className={'footer'}>\n          <a href={crt} target={\"_blank\"} download>点击下载根证书</a>\n          <div>\n            <p>            windows下配置信任根证书：<a target={\"_blank\"} href=\"https://jingyan.baidu.com/article/9f7e7ec0c1107c6f29155461.html\">点击查看</a></p>\n            <p>\n              mac下配置信任根证书：<a target={\"_blank\"} href=\"https://blog.51cto.com/viming/2161919\">点击查看</a>\n\n            </p>\n          </div>\n          {!this.state.connectError && (\n            <div>\n              <span className={'pac-config'}>\n                    自动代理配置url：{this.state.pacAddress}\n              </span>\n              <Popover content={<div><img src={require(\"./imgs/pac-tip.png\")} alt=\"\"/></div>} title=\"在mac中配置自动代理链接\">\n                <Icon type=\"question-circle\" />\n              </Popover>\n\n            </div>\n          )}\n          <Divider/>\n          <Collapse accordion>\n            <Panel header=\"如何备份我的配置\" key=\"1\">\n              <p>组件升级的时候，会覆盖安装组件，覆盖配置文件，为了保存你的配置文件，请拷贝配置文件到其他地方，当更新后，拷贝回来即可</p>\n            </Panel>\n          </Collapse>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport 'antd/dist/antd.css'\nReactDOM.render(<App />, document.getElementById('root'));\n\n"],"sourceRoot":""}