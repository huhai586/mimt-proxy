{"version":3,"sources":["rootCA.crt","configItem.js","App.js","index.js"],"names":["module","exports","confirm","Modal","Meta","Card","itemAction","delete","select","edit","ConfigItem","restartConfirm","title","content","okText","okType","cancelText","onOk","selectConfigConfirm","onCancel","console","log","selectCurItem","props","proxyIsRunning","selectConfig","data","doAction","action","this","spinning","runing","tip","onClick","turnOffProxyServer","fileName","actions","className","type","key","description","fileData","Component","crt","require","App","state","configs","startUpSuc","runningConfigName","connectError","pacAddress","params","SELECT_CONFIG","payload","ws","send","JSON","stringify","showMsg","status","info","message","processStartUp","startSuc","msg","setState","GET_PAC_ADDRESS","setCurrentConfig","setPacAddress","alert","WebSocket","onopen","evt","FETCH_ALL_CONFIGS","GET_CURRENT_CONFIG","onmessage","result","parse","e","warn","START_CALLBACK","onclose","setTimeout","window","location","reload","showIcon","map","v","index","length","href","target","download","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.1534bcdc.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/rootCA.45130045.crt\";","import './item.css';\n\nimport React,{Component} from 'react';\nimport {Card, Icon, Avatar, Spin, Modal} from 'antd';\nconst { confirm } = Modal;\n\nconst { Meta } = Card;\n\nconst itemAction = {\n  delete: 'delete',\n  select: 'select',\n  edit: 'edit'\n}\nexport default  class ConfigItem extends Component{\n  restartConfirm = () => {\n    confirm({\n      title: '切换配置',\n      content: '代理服务器运行中，需要换到当前配置吗？',\n      okText: '好的',\n      okType: 'danger',\n      cancelText: '取消切换',\n      onOk: () => {\n        this.selectConfigConfirm()\n      },\n      onCancel() {\n        console.log('Cancel');\n      },\n    });\n  }\n  \n  selectCurItem = () => {\n    if (this.props.proxyIsRunning) {\n      this.restartConfirm()\n    } else {\n      this.selectConfigConfirm()\n    }\n  }\n  selectConfigConfirm = () => {\n    this.props.selectConfig(this.props.data)\n  \n  }\n  doAction = (action) => {\n    switch (action) {\n      case itemAction.select:\n        this.selectCurItem();\n        break;\n      default:\n        console.log('没有相应的action', action)\n    }\n  }\n  render(){\n    const {data} = this.props;\n    return (\n      <Spin spinning={this.props.runing} tip={<div onClick={this.turnOffProxyServer}>代理中... </div>}>\n        <div>\n          <Card\n            title={data.fileName}\n            actions={[\n              <div className=\"icon-container\" onClick={() => {this.doAction(itemAction.select)}}>\n                <Icon type=\"heart\" key=\"heart\"/>\n                <span>选择</span>\n              </div>,\n              <div className=\"icon-container\">\n                <Icon type=\"edit\" key=\"edit\"/>\n                <span>修改</span>\n              </div>,\n              <div className=\"icon-container\">\n                <Icon type=\"delete\" key=\"delete\"/>\n                <span>删除</span>\n              </div>,\n            ]}\n          >\n            <Meta\n              description={data.fileData.description}\n            />\n          </Card>\n        </div>\n      </Spin>\n      \n    )\n  }\n}\n","\nimport React, {Component} from 'react';\nimport './App.css';\nimport { message,Alert } from 'antd';\nimport ConfigItem from './configItem';\nconst crt = require(\"./rootCA.crt\");\n\n\n\nconst actions = {\n  'FETCH_ALL_CONFIGS': 'getAllConfig',\n  'SELECT_CONFIG': 'select_config',\n  'START_CALLBACK':'start_callback',\n  'GET_CURRENT_CONFIG': 'get_current_config',\n  'GET_PAC_ADDRESS': 'GET_PAC_ADDRESS'\n}\n\n\nclass App extends Component {\n  state = {\n    configs: [],\n    startUpSuc: false,\n    runningConfigName: '',\n    connectError: false,\n    pacAddress: ''\n  }\n  selectConfig = (data) => {\n    const params = {\n      action: actions.SELECT_CONFIG,\n      payload: data\n    }\n    this.ws.send(JSON.stringify(params))\n  }\n  showMsg = (status, info) => {\n    message[status](info)\n  }\n\n  processStartUp = (payload) => {\n    this.showMsg(payload.startSuc ? 'success' : 'error', payload.msg);\n    this.setState({startUpSuc: payload.startSuc}, () => {\n      // !this.state.startUpSuc && this.restartConfirm()\n      if (this.state.startUpSuc) {\n        this.setState({runningConfigName: payload.fileName});\n        this.ws.send(JSON.stringify({action: actions.GET_PAC_ADDRESS}));\n      }\n    })\n  }\n  setCurrentConfig = (payload) => {\n    const {fileName} = payload;\n    this.setState({runningConfigName: fileName});\n    if (!!fileName) {\n      this.ws.send(JSON.stringify({action: actions.GET_PAC_ADDRESS}));\n    }\n  }\n  setPacAddress = (pacAddress) => {\n    this.setState({pacAddress})\n  }\n  componentDidMount() {\n    //发送请求获取配置信息\n    let ws = new WebSocket(\"ws://localhost:9876\");\n    this.ws = ws;\n    \n    ws.onopen = (evt) => {\n      console.log(\"Connection open ...\");\n      // ws.send(\"Hello WebSockets!\");\n      this.setState({connectError: false});\n      ws.send(JSON.stringify({action: actions.FETCH_ALL_CONFIGS}));\n      ws.send(JSON.stringify({action: actions.GET_CURRENT_CONFIG}));\n    };\n  \n    ws.onmessage = (evt) => {\n      console.log( \"Received Message: \" , evt.data);\n      // ws.close();\n      let result ;\n      try {\n        result = JSON.parse(evt.data);\n      } catch (e) {\n        console.warn('传递数据无法json化，格式错误');\n        return\n      }\n      if (result.action === actions.FETCH_ALL_CONFIGS) {\n        this.setState({configs: result.payload})\n      }\n      if (result.action === actions.START_CALLBACK) {\n        const {payload} = result;\n        this.processStartUp(payload)\n      }\n      if (result.action === actions.GET_CURRENT_CONFIG) {\n        const {payload} = result;\n        payload && this.setCurrentConfig(payload)\n      }\n      if (result.action === actions.GET_PAC_ADDRESS) {\n        const {payload} = result;\n        payload && this.setPacAddress(payload)\n      }\n    };\n  \n    ws.onclose = (evt) => {\n      console.log(\"Connection closed.\");\n      this.setState({connectError: true});\n      setTimeout(() => {\n        window.location.reload()\n      }, 10000)\n    };\n\n\n  }\n  turnOffProxyServer = () => {\n    alert(11)\n  }\n  render(){\n  \n    return (\n      <div className=\"App\">\n        {this.state.connectError && (\n          <Alert\n            message=\"与代理服务器的通信失败\"\n            description=\"代理服务器可能没有启动,10s后网页会刷新重试...\"\n            type=\"error\"\n            showIcon\n          />\n        )}\n          <div className={'config-container'}>\n            {this.state.configs.map((v,index) => {\n              return (\n                <ConfigItem\n                  selectConfig={this.selectConfig}\n                  data = {v}\n                  proxyIsRunning={this.state.runningConfigName.length !== 0}\n                  runing={this.state.runningConfigName=== v.fileName}\n                  key={index}/>\n              )\n            })}\n          </div>\n        \n        <div className={'footer'}>\n          <a href={crt} target={\"_blank\"} download>点击下载根证书</a>\n          {!this.state.connectError && (\n            <div>\n              自动代理配置url：{this.state.pacAddress}\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport 'antd/dist/antd.css'\nReactDOM.render(<App />, document.getElementById('root'));\n\n"],"sourceRoot":""}